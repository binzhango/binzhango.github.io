<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>

  <meta name="description" content="Recently I’m working in Azure to implement ETL jobs. The main tool is ADF (Azure Data Factory). This post show some solutions to resolve issue in my work.  Task Process CSV files and merge different s">
<meta property="og:type" content="article">
<meta property="og:title" content="Azure Data Factory (Data Flow)">
<meta property="og:url" content="http://example.com/2020/11/18/Azure-Data-Factory-Data-Flow/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Recently I’m working in Azure to implement ETL jobs. The main tool is ADF (Azure Data Factory). This post show some solutions to resolve issue in my work.  Task Process CSV files and merge different s">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/adf_pipeline.png">
<meta property="og:image" content="http://example.com/images/parameter.png">
<meta property="og:image" content="http://example.com/images/variables.png">
<meta property="og:image" content="http://example.com/images/getmetadata.png">
<meta property="og:image" content="http://example.com/images/foreach.png">
<meta property="og:image" content="http://example.com/images/variable_activity.png">
<meta property="og:image" content="http://example.com/images/dataflow.png">
<meta property="article:published_time" content="2020-11-19T02:27:29.000Z">
<meta property="article:modified_time" content="2020-11-25T14:25:42.849Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Azure">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/adf_pipeline.png">


<link rel="canonical" href="http://example.com/2020/11/18/Azure-Data-Factory-Data-Flow/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Azure Data Factory (Data Flow) | Hexo</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#task"><span class="nav-number">1.</span> <span class="nav-text"> Task</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#adf-pipeline"><span class="nav-number">2.</span> <span class="nav-text"> ADF Pipeline</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#activities"><span class="nav-number">3.</span> <span class="nav-text"> Activities</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#get-metadata"><span class="nav-number">3.0.1.</span> <span class="nav-text"> Get Metadata</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#foreach"><span class="nav-number">3.0.2.</span> <span class="nav-text"> ForEach</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#set-variables"><span class="nav-number">3.0.3.</span> <span class="nav-text"> Set Variables</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dataflow"><span class="nav-number">3.0.4.</span> <span class="nav-text"> Dataflow</span></a></li></ol></li></ol></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">9</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">
      

      

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/18/Azure-Data-Factory-Data-Flow/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Azure Data Factory (Data Flow)
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-18 21:27:29" itemprop="dateCreated datePublished" datetime="2020-11-18T21:27:29-05:00">2020-11-18</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2020-11-25 09:25:42" itemprop="dateModified" datetime="2020-11-25T09:25:42-05:00">2020-11-25</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DataFactory/" itemprop="url" rel="index"><span itemprop="name">DataFactory</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Recently I’m working in Azure to implement ETL jobs. The main tool is ADF (Azure Data Factory). This post show some solutions to resolve issue in my work.</p>
<h2 id="task"><a class="markdownIt-Anchor" href="#task"></a> Task</h2>
<p>Process CSV files and merge different system files into one file</p>
<ul>
<li>Source: CSV files with filename format (<em>abcd_yyyymmdd_uuid.csv</em>), where abcd is system id.
<ul>
<li>a_20180101_9ca2bed1-2ed0-eaeb-8401-784f43755025.csv</li>
<li>a_20180101_cca2bed1-aed0-11eb-8401-784f73755025.csv</li>
<li>b_20190202_ece2bed1-2ed0-abeb-8401-784f43755025.csv</li>
<li>c_20180101_ada2bed1-2ed0-22eb-8401-784f43755025.csv</li>
</ul>
</li>
<li>Sink: yyyymmdd.csv
<ul>
<li>20180101.csv</li>
<li>20190202.csv</li>
</ul>
</li>
</ul>
<h2 id="adf-pipeline"><a class="markdownIt-Anchor" href="#adf-pipeline"></a> ADF Pipeline</h2>
<p><img src="/images/adf_pipeline.png" alt="Pipeline" title="Pipeline" /><br />
<img src="/images/parameter.png" alt="" title="parameters" /><br />
<img src="/images/variables.png" alt="" title="variables" /></p>
<h2 id="activities"><a class="markdownIt-Anchor" href="#activities"></a> Activities</h2>
<h4 id="get-metadata"><a class="markdownIt-Anchor" href="#get-metadata"></a> Get Metadata</h4>
<ul>
<li>Input: source directory/parameters</li>
<li>Output: metadata of each object</li>
</ul>
<p>Get Metadata activity iterate source directory to obtain each object. The most important one is <strong>Argument</strong><br />
<img src="/images/getmetadata.png" alt="Get Metadata" title="Get Metadata" /></p>
<h4 id="foreach"><a class="markdownIt-Anchor" href="#foreach"></a> ForEach</h4>
<ul>
<li>Input: output of <em>Get Metadata</em></li>
<li>Output: None</li>
</ul>
<p>ForEach activity is used to process each object in source direcoty.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@activity(<span class="string">&#x27;Get Metadata1&#x27;</span>).output.childItems</span><br></pre></td></tr></table></figure>
<p><img src="/images/foreach.png" alt="" title="ForEach" /></p>
<h4 id="set-variables"><a class="markdownIt-Anchor" href="#set-variables"></a> Set Variables</h4>
<p>It’s convenient to predefine a value used in next step.</p>
<p><img src="/images/variable_activity.png" alt="" title="Set Variable" /></p>
<h4 id="dataflow"><a class="markdownIt-Anchor" href="#dataflow"></a> Dataflow</h4>
<p><img src="/images/dataflow.png" alt="" title="Dataflow" /></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Azure/" rel="tag"># Azure</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/03/01/Spark-Dataframe-window-function/" rel="prev" title="Spark Dataframe window function">
                  <i class="fa fa-chevron-left"></i> Spark Dataframe window function
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
  
  
  



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  















  








  

  

</body>
</html>
